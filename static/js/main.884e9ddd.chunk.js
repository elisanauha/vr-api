(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(t,e,a){},16:function(t,e,a){},17:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(8),s=a.n(i),o=(a(15),a(1)),l=a(2),c=a(4),u=a(3),h=a(5),m=a(6),p=(a(16),function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"HeaderPanel"},r.a.createElement("h1",null,"Aseman junatiedot"))}}]),e}(n.Component)),v=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"SearchField"},r.a.createElement("input",{onChange:this.props.onSearchChange,type:"text",name:"citysearch",value:this.props.searchTerm}))}}]),e}(n.Component),d=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"SearchPanel"},r.a.createElement("label",null,"Hae aseman nimell\xe4"),r.a.createElement(v,{onSearchChange:this.props.onSearchChange,searchTerm:this.props.searchTerm}),r.a.createElement("p",null,this.props.stationFull))}}]),e}(n.Component),f=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t="OddRow";this.props.i%2===0&&(t="EvenRow");var e=this.props.train,a="";a=this.props.arrivingTab?"ARRIVAL":"DEPARTURE";var n="";n="Commuter"===e.trainCategory?"Commuter train "+e.commuterLineID:e.trainType+" "+e.trainNumber;var i=[],s=!0,o=!1,l=void 0;try{for(var c,u=e.timeTableRows[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var h=c.value;h.type===a&&h.stationShortCode===this.props.station&&(h.differenceInMinutes>0&&h.liveEstimateTime?(i.push(r.a.createElement("p",{className:"lateOrCancelled",key:"estimate"},h.liveEstimateTime.slice(11,16))),i.push(r.a.createElement("span",{className:"late",key:"scheduledlate"},"(",h.scheduledTime.slice(11,16),")"))):i.push(r.a.createElement("span",{key:"scheduled"},h.scheduledTime.slice(11,16))))}}catch(C){o=!0,l=C}finally{try{s||null==u.return||u.return()}finally{if(o)throw l}}e.cancelled&&(i.push(r.a.createElement("p",{className:"lateOrCancelled",key:"cancelled"},"Cancelled")),t+="C");var m=e.timeTableRows[0].stationShortCode,p=e.timeTableRows[e.timeTableRows.length-1].stationShortCode,v="",d="",f=!0,b=!1,y=void 0;try{for(var g,E=this.props.stations[Symbol.iterator]();!(f=(g=E.next()).done);f=!0){var T=g.value;T.stationShortCode===m&&(v=T.stationName),T.stationShortCode===p&&(d=T.stationName)}}catch(C){b=!0,y=C}finally{try{f||null==E.return||E.return()}finally{if(b)throw y}}return v.endsWith("asema")&&(v=v.substr(0,v.length-5)),d.endsWith("asema")&&(d=d.substr(0,d.length-5)),r.a.createElement("tr",{className:t,key:this.props.i},r.a.createElement("td",null,n),r.a.createElement("td",null,v),r.a.createElement("td",null,d),r.a.createElement("td",null,i))}}]),e}(n.Component),b=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t="";t=this.props.arrivingTab?"Saapuu":"L\xe4htee";var e=[],a=1,n=!0,i=!1,s=void 0;try{for(var o,l=this.props.trains[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var c=o.value;this.props.arrivingTab&&c.timeTableRows[0].stationShortCode===this.props.station||!this.props.arrivingTab&&c.timeTableRows[c.timeTableRows.length-1].stationShortCode===this.props.station||(e.push(r.a.createElement(f,{train:c,i:a,station:this.props.station,stations:this.props.stations,arrivingTab:this.props.arrivingTab,key:a})),a++)}}catch(u){i=!0,s=u}finally{try{n||null==l.return||l.return()}finally{if(i)throw s}}return r.a.createElement("div",{className:"TrainTable"},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",{className:"HeaderRow"},r.a.createElement("th",null,"Juna"),r.a.createElement("th",null,"L\xe4ht\xf6asema"),r.a.createElement("th",null,"P\xe4\xe4teasema"),r.a.createElement("th",null,t)),e)))}}]),e}(n.Component),y=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t="inactive",e="active";return this.props.arrivingTab&&(t="active",e="inactive"),r.a.createElement("div",{className:"TrainTabs"},r.a.createElement("div",{className:"tab"},r.a.createElement("button",{className:t,id:"arriving",onClick:this.props.onTabChange},"Saapuvat"),r.a.createElement("button",{className:e,id:"leaving",onClick:this.props.onTabChange},"L\xe4htev\xe4t")),r.a.createElement(b,{trains:this.props.trains,station:this.props.station,arrivingTab:this.props.arrivingTab,stations:this.props.stations}))}}]),e}(n.Component),g=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={stations:null,searchTerm:"Tampere",station:"TPE",stationFull:"Tampere asema",arriving:!0,trains:[]},a.handleSearch=a.handleSearch.bind(Object(m.a)(Object(m.a)(a))),a.handleTabChange=a.handleTabChange.bind(Object(m.a)(Object(m.a)(a))),a}return Object(h.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;fetch("https://rata.digitraffic.fi/api/v1/metadata/stations").then(function(t){return t.json()}).then(function(e){var a=[],n=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;l.passengerTraffic&&a.push(l)}}catch(c){r=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}t.setState({stations:a})});var e="https://rata.digitraffic.fi/api/v1/live-trains/station/"+this.state.station+"?minutes_before_departure=400&minutes_after_departure=0&minutes_before_arrival=400&minutes_after_arrival=0";fetch(e).then(function(t){return t.json()}).then(function(e){var a=[],n=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var l=s.value;"Long-distance"!==l.trainCategory&&"Commuter"!==l.trainCategory||a.push(l)}}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var c=E(a,t.state.station,t.state.arriving);t.setState({trains:c})}).catch(function(t){return console.error("Error:",t)})}},{key:"handleSearch",value:function(t){var e=this,a=t.target.value,n=this.state.station,r=this.state.stationFull,i=!0,s=!1,o=void 0;try{for(var l,c=this.state.stations[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;if(u.stationName.toLowerCase().startsWith(a.toLowerCase())){n=u.stationShortCode,r=u.stationName;break}}}catch(m){s=!0,o=m}finally{try{i||null==c.return||c.return()}finally{if(s)throw o}}var h={searchTerm:a,station:n,stationFull:r};n!==this.state.station&&fetch("https://rata.digitraffic.fi/api/v1/live-trains/station/"+n+"?minutes_before_departure=480&minutes_after_departure=0&minutes_before_arrival=480&minutes_after_arrival=0").then(function(t){return t.json()}).then(function(t){var a=[],r=!0,i=!1,s=void 0;try{for(var o,l=t[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var c=o.value;"Long-distance"!==c.trainCategory&&"Commuter"!==c.trainCategory||a.push(c)}}catch(m){i=!0,s=m}finally{try{r||null==l.return||l.return()}finally{if(i)throw s}}var u=E(a,n,e.state.arriving);e.setState({trains:u})}).catch(function(t){return console.error("Error:",t)});this.setState(h)}},{key:"handleTabChange",value:function(t){var e=!1;"arriving"===t.target.id&&(e=!0);var a=JSON.parse(JSON.stringify(this.state.trains));a=E(a,this.state.station,e),this.setState({arriving:e,trains:a})}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(p,null),r.a.createElement(d,{onSearchChange:this.handleSearch,searchTerm:this.state.searchTerm,stationFull:this.state.stationFull}),r.a.createElement(y,{arrivingTab:this.state.arriving,onTabChange:this.handleTabChange,trains:this.state.trains,station:this.state.station,stations:this.state.stations}))}}]),e}(n.Component);function E(t,e,a){function n(t,a){var n="",r=!0,i=!1,s=void 0;try{for(var o,l=t.timeTableRows[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var c=o.value;if(c.stationShortCode===e&&c.type===a){n=c.scheduledTime;break}}}catch(u){i=!0,s=u}finally{try{r||null==l.return||l.return()}finally{if(i)throw s}}return n}return a?t.sort(function(t,e){var a=n(t,"ARRIVAL"),r=n(e,"ARRIVAL");return new Date(a)-new Date(r)}):t.sort(function(t,e){var a=n(t,"DEPARTURE"),r=n(e,"DEPARTURE");return new Date(a)-new Date(r)}),t}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},9:function(t,e,a){t.exports=a(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.884e9ddd.chunk.js.map